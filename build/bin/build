#!/usr/bin/env sh

WP_VERSION="${1:-}"

if [ -z "${WP_VERSION}" ]; then
  echo "Error: WP_VERSION is null"
  exit 1
fi

docker buildx create --use --name build --node build --driver-opt network=host
docker buildx build --pull --push --platform "linux/amd64,linux/armhf,linux/aarch64" --build-arg "WP_VERSION=${WP_VERSION}" --tag "nlss/wordpress:${WP_VERSION}" --tag "nlss/wordpress:latest" .